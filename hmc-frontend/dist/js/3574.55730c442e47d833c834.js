"use strict";(self.webpackChunkHMC=self.webpackChunkHMC||[]).push([[3574,3805,2575,8956,3379,3979,2193,8831],{63805:e=>{e.exports=r,e.exports.isMobile=r,e.exports.default=r;var t=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,n=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function r(e){e||(e={});var r=e.ua;if(r||"undefined"==typeof navigator||(r=navigator.userAgent),r&&r.headers&&"string"==typeof r.headers["user-agent"]&&(r=r.headers["user-agent"]),"string"!=typeof r)return!1;var a=e.tablet?n.test(r):t.test(r);return!a&&e.tablet&&e.featureDetect&&navigator&&navigator.maxTouchPoints>1&&-1!==r.indexOf("Macintosh")&&-1!==r.indexOf("Safari")&&(a=!0),a}},50843:(e,t,n)=>{n.d(t,{Z:()=>c});var r=n(95266),a=n(97293),o=n.n(a),l=n(67294);const c=function(e){var t=e.initial,n=l.useRef(null),a=l.useState(t),c=(0,r.Z)(a,2),u=c[0],i=c[1];return l.useEffect((function(){return i(t),n.current=o()((function(){i((function(e){return e+1}))}),1e3),function(){return clearInterval(n.current)}}),[t]),l.createElement("div",null,u+"s")}},4243:(e,t,n)=>{n.d(t,{E9:()=>c,MD:()=>r,OY:()=>o,RI:()=>l,XN:()=>a});var r=[{text:"部署成功",value:"deployed"},{text:"部署失败",value:"deploy fail"},{text:"部署中",value:"deploying"},{text:"卸载失败",value:"undeploy fail"},{text:"卸载中",value:"undeploying"}],a=[{text:"更新成功",value:"success"},{text:"更新失败",value:"fail"},{text:"更新中",value:"update"}],o={hosts:["主机集群"],kubernetes:["Kubernetes集群（自建集群）","Kubernetes集群（导入已有集群）"]},l={hosts:{title:"主机安装会经过2个状态：管控安装-主机初始化，若某一步安装失败，请查看具体日志。",filters:[{text:"管控安装成功",value:"管控安装成功"},{text:"管控安装失败",value:"管控安装失败"},{text:"script安装成功",value:"script安装成功"},{text:"script安装失败",value:"script安装失败"},{text:"主机初始化成功",value:"主机初始化成功"},{text:"主机初始化失败",value:"主机初始化失败"}],finalStatus:3},kubernetes:{title:"Kubernetes集群主机安装会经过5个状态：管控安装-主机初始化-K8S Docker初始化-K8S Node初始化-K8S Node部署成功，若某一步安装失败，请查看具体日志",filters:[{text:"管控安装失败",value:"管控安装失败",status:-1},{text:"管控安装成功",value:"管控安装成功",status:1},{text:"主机初始化失败",value:"主机初始化失败",status:-3},{text:"主机初始化成功",value:"主机初始化成功",status:3},{text:"K8S DOCKER初始化失败",value:"K8S DOCKER初始化失败",status:-5},{text:"K8S DOCKER初始化成功",value:"K8S DOCKER初始化成功",status:5},{text:"K8S NODE初始化失败",value:"K8S NODE初始化失败",status:-6},{text:"K8S NODE初始化成功",value:"K8S NODE初始化成功",status:6},{text:"K8S NODE部署失败",value:"K8S NODE部署失败",status:-7},{text:"K8S NODE部署成功",value:"K8S NODE部署成功",status:7}],finalStatus:7}},c={NAMESPACE:"em_current_k8s_namespace"}},55660:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ue,operationMaps:()=>ce,statusMap:()=>le});var r=n(28222),a=n.n(r),o=n(80222),l=n.n(o),c=n(14418),u=n.n(c),i=n(8446),s=n.n(i),m=n(86),f=n.n(m),d=n(66870),p=n.n(d),v=n(29747),g=n.n(v),_=n(96718),h=n.n(_),b=n(44845),E=n(95266),x=n(39022),S=n.n(x),Z=n(87198),y=n.n(Z),w=n(35627),C=n.n(w),N=n(2357),k=n.n(N),D=n(67294),K=n(45360),O=n(8263),T=n(11382),M=n(52553),I=n(36808),j=n(43663),Y=n(11882),R=n.n(Y),H=n(97606),A=n.n(H),B=n(70586),F=n.n(B),P=n(34041),z=n(39903),L=n(10114),V=n(4107),U=n(67908),G=n(30381),W=n.n(G);function $(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=u()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=$(Object(a),!0)).call(n,(function(t){(0,b.Z)(e,t,a[t])})):p()?g()(e,p()(a)):f()(r=$(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}var X=P.Z.Option,q=z.Z.RangePicker,J=function(e){var t=e.handleEvent,n=D.useState([]),r=(0,E.Z)(n,2),a=r[0],o=r[1],l=D.useState([]),c=(0,E.Z)(l,2),i=c[0],s=c[1];D.useEffect((function(){m()}),[]);var m=function(){j.mt.getEchoSearchList({clusterId:I.get("em_current_cluster_id")}).then((function(e){var t=e.data;0===t.code?(o(t.data||[]),s(t.data||[])):K.Z.error(t.msg)}))};return D.createElement(L.Z,{dataSource:A()(i).call(i,(function(e){return D.createElement(X,{key:e},e)})),onSelect:function(e){t((function(t){return Q(Q({},t),{},{objectValue:e,page:1})}))},onChange:function(e){return function(e){var n=a;e?n=u()(a).call(a,(function(t){var n;return e&&R()(n=t.toLowerCase()).call(n,e.toLowerCase())>-1})):t((function(t){return Q(Q({},t),{},{objectValue:e,page:1})})),s(n)}(e)},allowClear:!0},D.createElement(V.Z,{placeholder:"请输入搜索关键词",suffix:D.createElement(U.Z,{type:"search"})}))};const ee=function(e){var t,n=e.handleEvent;return D.createElement("div",{className:"echo-form clearfix mb-12"},D.createElement("span",{className:"mr-20"},"对象：",D.createElement(J,{handleEvent:n})),D.createElement("span",{className:"mr-20"},"操作：",D.createElement(P.Z,{placeholder:"请选择命令",showSearch:!0,onChange:function(e){n((function(t){return Q(Q({},t),{},{operationType:e,page:1})}))},allowClear:!0},A()(t=a()(ce)).call(t,(function(e){return D.createElement(X,{key:e,value:e},ce[e])})))),D.createElement("span",{className:"mr-20"},"状态：",D.createElement(P.Z,{placeholder:"请选择状态",showSearch:!0,onChange:function(e){n((function(t){return Q(Q({},t),{},{status:e,page:1})}))},allowClear:!0},D.createElement(X,{value:"2"},"正常"),D.createElement(X,{value:"3"},"失败"),D.createElement(X,{value:"1"},"进行中"))),D.createElement("span",{className:"mr-20"},"开始时间：",D.createElement(q,{format:"YYYY-MM-DD HH:mm",disabledDate:te,showTime:!0,onChange:function(e,t){t.length&&""===t[0]&&""===t[1]&&n((function(e){return Q(Q({},e),{},{startTime:t[0],endTime:t[1],page:1})}))},onOk:function(e){var t=e&&e.length?W()(e[0]).format("YYYY-MM-DD HH:mm"):"",r=e&&e.length?W()(e[1]).format("YYYY-MM-DD HH:mm"):"";if(t&&r&&t===r)return K.Z.warning("开始时间必须小于结束时间！");n((function(e){return Q(Q({},e),{},{startTime:t,endTime:r,page:1})}))}})))};function te(e){return e&&e.valueOf()>F()()}var ne=n(50843),re=n(82193);function ae(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=u()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=ae(Object(a),!0)).call(n,(function(t){(0,b.Z)(e,t,a[t])})):p()?g()(e,p()(a)):f()(r=ae(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}var le={2:{label:"正常",value:"success"},3:{label:"失败",value:"error"},1:{label:"进行中",value:"processing"}},ce={1:"产品包部署",2:"补丁包升级",3:"产品包启动",4:"服务启动",5:"服务滚动重启",6:"主机初始化",7:"Kerberos开启",8:"Kerberos关闭"};const ue=function(e){var t=e.history,n=e.location,r=D.useState({clusterId:I.get("em_current_cluster_id"),operationType:void 0,objectValue:"",status:"",startTime:"",endTime:"",page:1,pageSize:10}),a=(0,E.Z)(r,2),o=a[0],l=a[1],c=D.useState([]),u=(0,E.Z)(c,2),i=u[0],s=u[1],m=D.useState(0),f=(0,E.Z)(m,2),d=f[0],p=f[1],v=D.useState(!1),g=(0,E.Z)(v,2),_=g[0],h=g[1],b=D.useState(!1),x=(0,E.Z)(b,2),Z=x[0],w=x[1],N={current:o.page,pageSize:o.pageSize,total:d,size:"small",showTotal:function(e){var t;return S()(t="共 ".concat(e," 条数据，每页显示 ")).call(t,o.pageSize," 条")}},Y=D.useRef(null);D.useEffect((function(){return R(),function(){h(!0),clearTimeout(Y.current)}}),[o]);var R=function e(){var t=oe(oe({},o),{},{startTime:o.startTime||void 0,endTime:o.endTime||void 0,status:o.status||void 0,objectValue:o.objectValue||void 0});w(!0),j.mt.getEchoOrder(t).then((function(t){var n=t.data;if(0===n.code){if(s(n.data.list),p(n.data.count),w(!1),_)return null;Y.current=y()((function(){e()}),5e3)}else K.Z.error(n.msg)}))};return D.createElement("div",{className:"scriptecho-page"},D.createElement(ee,{handleEvent:l}),D.createElement(O.Z,{rowKey:"operationId",className:"dt-table-fixed-base",style:{height:"calc(100vh - 230px)"},dataSource:i,onChange:function(e,t,n){l((function(t){return oe(oe({},t),{},{page:e.current})}))},pagination:N,loading:Z,scroll:{y:!0}},D.createElement(O.Z.Column,{title:"",width:30,key:"operationId",render:function(e,t){return D.createElement("div",null,1===t.operationStatus?D.createElement(T.Z,{size:"small"}):D.createElement("span",null," "))}}),D.createElement(O.Z.Column,{title:"对象",width:"20%",dataIndex:"objectValue",render:function(e,n){return D.createElement("a",{onClick:function(e){return function(e){if(K.Z.destroy(),!e.isExist)return K.Z.warning("该组件已从该集群卸载！");var n="";switch(e.objectType){case 1:n="/deploycenter/cluster/detail/deployed",re.Z.setNaviKey("menu_deploy_center","sub_menu_cluster_list");break;case 2:n="/opscenter/service",I.set("em_product_id",""),I.set("em_product_name",e.productName),I.set("em_current_parent_product",e.parentProductName),re.Z.setNaviKey("menu_ops_center","sub_menu_service");break;default:n="/opscenter/hoststatus",e=oe(oe({},e),{},{hostIp:e.objectValue}),I.set("em_product_id",""),I.set("em_product_name",e.productName),I.set("em_current_parent_product",e.parentProductName),re.Z.setNaviKey("menu_ops_center","sub_menu_host")}sessionStorage.setItem("service_object",C()(e)),t.push(n)}(n)}},e)}}),D.createElement(O.Z.Column,{title:"操作",dataIndex:"operationName",render:function(e,r){return D.createElement("a",{onClick:function(e){return function(e){t.push("/deploycenter/cluster/detail/echoDetail?from=".concat(n.pathname),e)}(r)}},e)}}),D.createElement(O.Z.Column,{title:"状态",dataIndex:"operationStatus",render:function(e){var t=le[e];return D.createElement("span",null,D.createElement(M.Z,{status:t.value})," ",t.label)}}),D.createElement(O.Z.Column,{title:"开始时间",dataIndex:"startTime"}),D.createElement(O.Z.Column,{title:"持续时间",width:"12%",dataIndex:"duration",render:function(e,t){return 1===t.operationStatus?D.createElement(ne.Z,{initial:k()(e)}):e+"s"}})))}},82193:(e,t,n)=>{n.d(t,{Z:()=>h});var r=n(39022),a=n.n(r),o=n(86),l=n.n(o),c=n(11882),u=n.n(c),i=n(97606),s=n.n(i),m=n(28222),f=n.n(m),d=n(2357),p=n.n(d),v=n(45360),g=n(36808),_=n(4243);const h={pageWidth:function(){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)},pageHeight:function(){return Math.max(document.documentElement.clientHeight,window.innerHeight||0)},getParameterByName:function(e,t){t||(t=window.location.href),e=e.replace(/[[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},getBase64:function(e,t){var n=new FileReader;n.addEventListener("load",(function(){return t(n.result)})),n.readAsDataURL(e)},percent:function(e,t){return e&&e!==1/0?(e>1&&(e=1),t=t||2,t=Math.pow(10,t),Math.round(e*t*100)/t+"%"):"0%"},getCssText:function(e){var t="";for(var n in e)t+=n+":"+e[n]+";";return t},formateDateTime:function(e){var t,n,r,o,l;if(!e)return"";var c=new Date(e),u=c.getFullYear(),i=c.getMonth()+1+"",s=c.getDate()+"",m=c.getHours()+"",f=c.getMinutes()+"",d=c.getSeconds()+"";return 1===i.toString().length&&(i="0".concat(i)),1===s.toString().length&&(s="0".concat(s)),1===m.toString().length&&(m="0".concat(m)),1===f.toString().length&&(f="0".concat(f)),1===d.toString().length&&(d="0".concat(d)),a()(t=a()(n=a()(r=a()(o=a()(l="".concat(u,"-")).call(l,i,"-")).call(o,s," ")).call(r,m,":")).call(n,f,":")).call(t,d)},formateDate:function(e){var t,n;if(!e)return"";var r=new Date(e),o=r.getFullYear(),l=r.getMonth()+1+"",c=r.getDate()+"";return 1===l.toString().length&&(l="0".concat(l)),1===c.toString().length&&(c="0".concat(c)),a()(t=a()(n="".concat(o,"-")).call(n,l,"-")).call(t,c)},trim:function(e){return"string"==typeof e?e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""):e},messageFilter:function(e,t,n,r){1001===e.status.code&&(r||v.Z.success("成功"),t&&t())},getTableParam:function(e){var t={};return l()(e).call(e,(function(e,n){var r=e.split("-");t[r[1]]=r[2]})),t},setAlertControl:function(e){var t={},n=e.alert_control;return"1"===n?t.close=1:(t.close=0,e["alert_num_"+n]&&(t.times_after_close=e["alert_num_"+n]),e["recover_num_"+n]&&(t.close_after_long_time_reset_amount=e["recover_num_"+n],t.close_after_long_time_reset_unit=e["recover_unit_"+n])),t},getAlertControl:function(e){var t={alert_control:""};return 0===e.close&&(0!==e.times_after_close?(t.alert_control="2",t["alert_num_"+t.alert_control]=e.times_after_close):t.alert_control="3",""!==e.close_after_long_time_reset_amount&&("2"===t.alert_control&&(t.alert_control="4"),t["alert_num_"+t.alert_control]=e.times_after_close,t["recover_num_"+t.alert_control]=e.close_after_long_time_reset_amount,t["recover_unit_"+t.alert_control]=e.close_after_long_time_reset_unit)),t},filterOption:function(e,t){var n;return-1!==u()(n=t.props.children).call(n,e)},getParamsFromUrl:function(e){var t={},n=[],r="",a="",o=e.substring(u()(e).call(e,"?")+1,e.length).split("&");for(var l in o)r=(n=o[l].split("="))[0],a=n[1],t[r]=a;return t},jsonToQuery:function(e){var t;return e?function(e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t}(s()(t=f()(e)).call(t,(function(t){return void 0===e[t]?"":encodeURIComponent(t)+"="+encodeURIComponent(e[t])}))).join("&"):""},checkNullObj:function(e){return 0===f()(e).length},serviceCallback:function(e,t,n){0===e.data.code?(v.Z.success(t),n&&n()):v.Z.error(e.data.msg)},noAuthorityToDO:function(e,t){return!e[t]&&(v.Z.error("权限不足，请联系管理员!"),!0)},get k8sNamespace(){return g.get(_.E9.NAMESPACE)},setNaviKey:function(e,t){sessionStorage.setItem("firstLevelNav",e),sessionStorage.setItem("siderLevelNav",t)},formatGBUnit:function(e){return u()(e).call(e,"MB")>-1?p()(e.replace("MB",""))/1024:u()(e).call(e,"KB")>-1?p()(e.replace("KB",""))/1024/1024:u()(e).call(e,"GB")>-1?p()(e.replace("GB","")):u()(e).call(e,"TB")>-1?1024*p()(e.replace("TB","")):0}}}}]);