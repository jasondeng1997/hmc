(self.webpackChunkHMC=self.webpackChunkHMC||[]).push([[89],{80991:(t,e,o)=>{o(97690);var r=o(35703);t.exports=r("Array").includes},58557:(t,e,o)=>{var r=o(7046),n=o(80991),i=o(21631),l=Array.prototype,a=String.prototype;t.exports=function(t){var e=t.includes;return t===l||r(l,t)&&e===l.includes?n:"string"==typeof t||t===a||r(a,t)&&e===a.includes?i:e}},21631:(t,e,o)=>{o(11035);var r=o(35703);t.exports=r("String").includes},67772:(t,e,o)=>{var r=o(99813)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(o){try{return e[r]=!1,"/./"[t](e)}catch(t){}}return!1}},60685:(t,e,o)=>{var r=o(10941),n=o(82532),i=o(99813)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[i])?!!e:"RegExp"==n(t))}},70344:(t,e,o)=>{var r=o(60685),n=TypeError;t.exports=function(t){if(r(t))throw n("The method doesn't accept regular expressions");return t}},97690:(t,e,o)=>{"use strict";var r=o(76887),n=o(31692).includes,i=o(95981),l=o(18479);r({target:"Array",proto:!0,forced:i((function(){return!Array(1).includes()}))},{includes:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),l("includes")},11035:(t,e,o)=>{"use strict";var r=o(76887),n=o(95329),i=o(70344),l=o(48219),a=o(85803),c=o(67772),s=n("".indexOf);r({target:"String",proto:!0,forced:!c("includes")},{includes:function(t){return!!~s(a(l(this)),a(i(t)),arguments.length>1?arguments[1]:void 0)}})},33778:(t,e,o)=>{var r=o(58557);t.exports=r},89010:(t,e,o)=>{"use strict";var r=o(54657);t.exports=function(t,e,o){o=o||{},9===e.nodeType&&(e=r.getWindow(e));var n=o.allowHorizontalScroll,i=o.onlyScrollIfNeeded,l=o.alignWithTop,a=o.alignWithLeft,c=o.offsetTop||0,s=o.offsetLeft||0,d=o.offsetBottom||0,u=o.offsetRight||0;n=void 0===n||n;var f=r.isWindow(e),p=r.offset(t),v=r.outerHeight(t),h=r.outerWidth(t),m=void 0,g=void 0,y=void 0,w=void 0,b=void 0,C=void 0,Z=void 0,S=void 0,x=void 0,E=void 0;f?(Z=e,E=r.height(Z),x=r.width(Z),S={left:r.scrollLeft(Z),top:r.scrollTop(Z)},b={left:p.left-S.left-s,top:p.top-S.top-c},C={left:p.left+h-(S.left+x)+u,top:p.top+v-(S.top+E)+d},w=S):(m=r.offset(e),g=e.clientHeight,y=e.clientWidth,w={left:e.scrollLeft,top:e.scrollTop},b={left:p.left-(m.left+(parseFloat(r.css(e,"borderLeftWidth"))||0))-s,top:p.top-(m.top+(parseFloat(r.css(e,"borderTopWidth"))||0))-c},C={left:p.left+h-(m.left+y+(parseFloat(r.css(e,"borderRightWidth"))||0))+u,top:p.top+v-(m.top+g+(parseFloat(r.css(e,"borderBottomWidth"))||0))+d}),b.top<0||C.top>0?!0===l?r.scrollTop(e,w.top+b.top):!1===l?r.scrollTop(e,w.top+C.top):b.top<0?r.scrollTop(e,w.top+b.top):r.scrollTop(e,w.top+C.top):i||((l=void 0===l||!!l)?r.scrollTop(e,w.top+b.top):r.scrollTop(e,w.top+C.top)),n&&(b.left<0||C.left>0?!0===a?r.scrollLeft(e,w.left+b.left):!1===a?r.scrollLeft(e,w.left+C.left):b.left<0?r.scrollLeft(e,w.left+b.left):r.scrollLeft(e,w.left+C.left):i||((a=void 0===a||!!a)?r.scrollLeft(e,w.left+b.left):r.scrollLeft(e,w.left+C.left)))}},34979:(t,e,o)=>{"use strict";t.exports=o(89010)},54657:t=>{"use strict";var e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r])}return t},o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function r(t,e){var o=t["page"+(e?"Y":"X")+"Offset"],r="scroll"+(e?"Top":"Left");if("number"!=typeof o){var n=t.document;"number"!=typeof(o=n.documentElement[r])&&(o=n.body[r])}return o}function n(t){return r(t)}function i(t){return r(t,!0)}function l(t){var e=function(t){var e,o=void 0,r=void 0,n=t.ownerDocument,i=n.body,l=n&&n.documentElement;return o=(e=t.getBoundingClientRect()).left,r=e.top,{left:o-=l.clientLeft||i.clientLeft||0,top:r-=l.clientTop||i.clientTop||0}}(t),o=t.ownerDocument,r=o.defaultView||o.parentWindow;return e.left+=n(r),e.top+=i(r),e}var a=new RegExp("^("+/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source+")(?!px)[a-z%]+$","i"),c=/^(top|right|bottom|left)$/,s="left";var d=void 0;function u(t,e){for(var o=0;o<t.length;o++)e(t[o])}function f(t){return"border-box"===d(t,"boxSizing")}"undefined"!=typeof window&&(d=window.getComputedStyle?function(t,e,o){var r="",n=t.ownerDocument,i=o||n.defaultView.getComputedStyle(t,null);return i&&(r=i.getPropertyValue(e)||i[e]),r}:function(t,e){var o=t.currentStyle&&t.currentStyle[e];if(a.test(o)&&!c.test(e)){var r=t.style,n=r[s],i=t.runtimeStyle[s];t.runtimeStyle[s]=t.currentStyle[s],r[s]="fontSize"===e?"1em":o||0,o=r.pixelLeft+"px",r[s]=n,t.runtimeStyle[s]=i}return""===o?"auto":o});var p=["margin","border","padding"];function v(t,e,o){var r={},n=t.style,i=void 0;for(i in e)e.hasOwnProperty(i)&&(r[i]=n[i],n[i]=e[i]);for(i in o.call(t),e)e.hasOwnProperty(i)&&(n[i]=r[i])}function h(t,e,o){var r=0,n=void 0,i=void 0,l=void 0;for(i=0;i<e.length;i++)if(n=e[i])for(l=0;l<o.length;l++){var a=void 0;a="border"===n?n+o[l]+"Width":n+o[l],r+=parseFloat(d(t,a))||0}return r}function m(t){return null!=t&&t==t.window}var g={};function y(t,e,o){if(m(t))return"width"===e?g.viewportWidth(t):g.viewportHeight(t);if(9===t.nodeType)return"width"===e?g.docWidth(t):g.docHeight(t);var r="width"===e?["Left","Right"]:["Top","Bottom"],n="width"===e?t.offsetWidth:t.offsetHeight,i=(d(t),f(t)),l=0;(null==n||n<=0)&&(n=void 0,(null==(l=d(t,e))||Number(l)<0)&&(l=t.style[e]||0),l=parseFloat(l)||0),void 0===o&&(o=i?1:-1);var a=void 0!==n||i,c=n||l;if(-1===o)return a?c-h(t,["border","padding"],r):l;if(a){var s=2===o?-h(t,["border"],r):h(t,["margin"],r);return c+(1===o?0:s)}return l+h(t,p.slice(o),r)}u(["Width","Height"],(function(t){g["doc"+t]=function(e){var o=e.document;return Math.max(o.documentElement["scroll"+t],o.body["scroll"+t],g["viewport"+t](o))},g["viewport"+t]=function(e){var o="client"+t,r=e.document,n=r.body,i=r.documentElement[o];return"CSS1Compat"===r.compatMode&&i||n&&n[o]||i}}));var w={position:"absolute",visibility:"hidden",display:"block"};function b(t){var e=void 0,o=arguments;return 0!==t.offsetWidth?e=y.apply(void 0,o):v(t,w,(function(){e=y.apply(void 0,o)})),e}function C(t,e,r){var n=r;if("object"!==(void 0===e?"undefined":o(e)))return void 0!==n?("number"==typeof n&&(n+="px"),void(t.style[e]=n)):d(t,e);for(var i in e)e.hasOwnProperty(i)&&C(t,i,e[i])}u(["width","height"],(function(t){var e=t.charAt(0).toUpperCase()+t.slice(1);g["outer"+e]=function(e,o){return e&&b(e,t,o?0:1)};var o="width"===t?["Left","Right"]:["Top","Bottom"];g[t]=function(e,r){if(void 0===r)return e&&b(e,t,-1);if(e){d(e);return f(e)&&(r+=h(e,["padding","border"],o)),C(e,t,r)}}})),t.exports=e({getWindow:function(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow},offset:function(t,e){if(void 0===e)return l(t);!function(t,e){"static"===C(t,"position")&&(t.style.position="relative");var o=l(t),r={},n=void 0,i=void 0;for(i in e)e.hasOwnProperty(i)&&(n=parseFloat(C(t,i))||0,r[i]=n+e[i]-o[i]);C(t,r)}(t,e)},isWindow:m,each:u,css:C,clone:function(t){var e={};for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);if(t.overflow)for(var o in t)t.hasOwnProperty(o)&&(e.overflow[o]=t.overflow[o]);return e},scrollLeft:function(t,e){if(m(t)){if(void 0===e)return n(t);window.scrollTo(e,i(t))}else{if(void 0===e)return t.scrollLeft;t.scrollLeft=e}},scrollTop:function(t,e){if(m(t)){if(void 0===e)return i(t);window.scrollTo(n(t),e)}else{if(void 0===e)return t.scrollTop;t.scrollTop=e}},viewportWidth:0,viewportHeight:0},g)},6519:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>$});var r=o(28760),n=o.n(r),i=o(71649),l=o(44930),a=o(68420),c=o(27344),s=o(5281),d=o(84441),u=o(3020),f=o(3362),p=o(44845),v=o(30222),h=o.n(v),m=o(76986),g=o.n(m),y=o(39022),w=o.n(y),b=o(97606),C=o.n(b),Z=o(6226),S=o.n(Z),x=o(86),E=o.n(x),L=o(58118),T=o.n(L),W=o(35627),V=o.n(W),R=o(67294),H=o(69035),P=o(45360),k=o(4107),F=o(77268),O=o(97779),B=o(39100),N=o(29027),_=o(43663),D=o(40174),A=o(72536),M=o(98396),z=o(36808);function j(t){var e=function(){if("undefined"==typeof Reflect||!n())return!1;if(n().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n()(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=(0,f.Z)(t);if(e){var i=(0,f.Z)(this).constructor;o=n()(r,arguments,i)}else o=r.apply(this,arguments);return(0,u.Z)(this,o)}}var I=H.Z.Item,q=function(t){(0,d.Z)(r,t);var e=j(r);function r(){var t,o;(0,a.Z)(this,r);for(var n=arguments.length,c=new Array(n),d=0;d<n;d++)c[d]=arguments[d];return o=e.call.apply(e,w()(t=[this]).call(t,c)),(0,p.Z)((0,s.Z)(o),"state",{validCode:"",needValidCode:!0}),(0,p.Z)((0,s.Z)(o),"initValidCode",(function(){_.bS.getValidCode().then((function(t){0===(t=t.data).code?o.setState({validCode:t.data,needValidCode:t.data.length>0}):P.Z.error(t.msg)}))})),(0,p.Z)((0,s.Z)(o),"validHasDeployedProduct",(function(t){var e=o.props.history;_.t6.getParentProductList().then((function(r){if(0===(r=r.data).code)if(0===r.data.length)e.push("/deploycenter/cluster/list?from="+o.props.location.pathname);else{var n,i=[];C()(n=r.data).call(n,(function(t){i.push(new(S())((function(e,o){_.BZ.getProductList({limit:0,parentProductName:t}).then((function(t){0===(t=t.data).code?e(t.data.list):P.Z.error(t.msg)}))})))}));var l=!0;S().all(i).then((function(r){C()(r).call(r,(function(t){C()(t).call(t,(function(t){1===t.is_current_version&&(l=!1)}))})),l?e.push("/deploycenter/cluster/list?from="+o.props.location.pathname):t()}))}else P.Z.error(r.msg)}))})),(0,p.Z)((0,s.Z)(o),"validCodeValue",(function(t,e){_.bS.checkValidCode(t).then((function(t){return e(t)}))})),(0,p.Z)((0,s.Z)(o),"goLogin",function(){var t=(0,l.Z)(h().mark((function t(e){var r,n,i,l;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.bS.getPublicKey();case 2:if(0===(r=t.sent).data.code){t.next=5;break}return t.abrupt("return");case 5:n=r.data.data,i=n.encrypt_type,l=n.encrypt_public_key,_.bS.login({username:e.username,password:"sm2"===i?(0,A.ON)(e.password,l):(0,A.g8)(e.password,l)}).then((function(t){z.set("em_token",t.headers.em_token),z.set("em_username",e.username),z.set("em_admin",t.headers.em_admin),0===(t=t.data).code?(o.getAuthorityRouter(),o.validHasDeployedProduct((function(){window.location.href="/"})),o.getRestartService()):(P.Z.error(t.msg),o.initValidCode())}));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),(0,p.Z)((0,s.Z)(o),"getRestartService",(function(){M.get("/api/v2/cluster/restartServices",{}).then((function(t){var e,r,n,i,l;0===(t=t.data).code?null===(e=o.props.actions)||void 0===e||e.setResartServiceList({count:(null===(r=t)||void 0===r||null===(n=r.data)||void 0===n?void 0:n.count)||0,list:(null===(i=t)||void 0===i||null===(l=i.data)||void 0===l?void 0:l.list)||[]}):P.Z.error(t.msg)}))})),(0,p.Z)((0,s.Z)(o),"authorityRouterFilter",(function(t,e,r){return E()(e).call(e,(function(e){T()(r).call(r,e.code)&&t.push.apply(t,(0,i.Z)(e.routers)),e.children.length&&o.authorityRouterFilter(t,e.children,r)})),t})),(0,p.Z)((0,s.Z)(o),"getAuthorityRouter",(function(){_.bS.getRoleCodes().then((function(t){var e=t.data,r=e.code,n=e.data;if(0===r){var i=[];o.authorityRouterFilter(i,D.B,n),localStorage.setItem("authorityRouter",V()(i))}}))})),(0,p.Z)((0,s.Z)(o),"handleLogin",(function(){var t=o.props.form;t.validateFields((function(e,r){if(!e){var n={username:r.username,password:r.password};o.state.needValidCode?o.validCodeValue({captchaId:o.state.validCode,captchaSolution:r.validCode},(function(e){if(0!==(e=e.data).code)return P.Z.error(e.msg),o.initValidCode(),void t.setFieldsValue([{validCode:void 0}]);o.goLogin(n)})):o.goLogin(n)}}))})),o}return(0,c.Z)(r,[{key:"componentDidMount",value:function(){this.initValidCode()}},{key:"render",value:function(){var t=this.props.form.getFieldDecorator;return R.createElement("div",{className:"login-container",style:{height:document.body.clientHeight}},R.createElement("div",{className:"header"},R.createElement("a",{href:"/",className:"header-logo-wrapper"},R.createElement("img",{src:o(97008)}),R.createElement("span",{className:"header-logo-name"},"HClusterManager"))),R.createElement("div",{style:{height:document.body.clientHeight-40,width:"100%"}},R.createElement("img",{className:"bg-img",src:o(88992)}),R.createElement("div",{className:"content",style:{minHeight:this.state.needValidCode?330:275}},R.createElement("p",{style:{fontSize:18,color:"#333333",marginBottom:31}},"欢迎登录HMC管理平台"),R.createElement(H.Z,null,R.createElement(I,null,t("username",{rules:[{required:!0,message:"用户名不能为空"}]})(R.createElement(k.Z,{style:{width:330,height:40},placeholder:"请输入账号信息"}))),R.createElement(I,null,t("password",{rules:[{required:!0,message:"密码不能为空"}]})(R.createElement(k.Z,{style:{width:330,height:40},placeholder:"请输入登录密码",type:"password"}))),this.state.needValidCode&&R.createElement(I,null,t("validCode",{rules:[{required:!0,message:"验证码不能为空"}]})(R.createElement("span",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},R.createElement(k.Z,{style:{width:200,height:40},placeholder:"验证码"}),R.createElement("img",{title:"点击更换验证码",style:{width:120,height:36,cursor:"pointer"},onClick:this.initValidCode,src:this.state.validCode?"/api/v2/user/showCaptcha/".concat(this.state.validCode,".png"):""})))),R.createElement(F.Z,{htmlType:"submit",onClick:this.handleLogin,type:"primary",style:{width:"100%",height:40,fontSize:14,marginBottom:10}},"登录")))),R.createElement("div",{className:"version",style:{position:"fixed",bottom:10,left:"50%",transform:"translate(-50%,0)"}},"ChengYing@V","1.1.0"))}}]),r}(R.Component);const $=(0,N.$j)(void 0,(function(t){return{actions:(0,O.DE)(g()({},B),t)}}))(H.Z.create()(q))},88992:(t,e,o)=>{"use strict";t.exports=o.p+"images/099b4171989c4cc9d193.png"},58118:(t,e,o)=>{t.exports=o(33778)}}]);